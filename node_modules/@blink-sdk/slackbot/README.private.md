# @blink-sdk/slackbot

The Blink SDK for creating your own agentic Slack bot.

<img src="./demo.png" alt="Demo" style="width: 640px;" />

## Getting Started

1. Create a new Blink agent:

   ```bash
   pnpx blink init
   # Start the agent in your terminal.
   pnpx blink dev
   ```

2. Install the Slackbot SDK:

   ```bash
   pnpm install @blink-sdk/slackbot
   ```

3. Create a webhook handler in your agent:

   ```ts
   import * as slackbot from "@blink-sdk/slackbot";

   export default blink.agent({
     async webhook(request) {
       if (slackbot.isOAuthRequest(request)) {
         return slackbot.handleOAuthRequest(request);

       if (slackbot.isWebhook(request)) {
         return slackbot.handleWebhook(request);
       }
     },
   });
   ```

4. Create a Slack App:

   Head to [the Slack App Dashboard](https://api.slack.com/apps) and create a new app.

   > [!NOTE]
   > The [example manifest](./example-manifest.json) is an easy way to get started. Use the devhook from `blink dev` for all the URLs.

5. Add the following environment variables to `.env.local`:

   ```bash
   SLACK_CLIENT_ID=your-client-id
   SLACK_CLIENT_SECRET=your-client-secret
   SLACK_SIGNING_SECRET=your-signing-secret
   ```

6. Install the Slack App from the "Manage Distribution" section on https://api.slack.com/apps.

7. @ mention your bot in any channel to start chatting.

## Example

This is a complete example of a working Slackbot agent.

```ts
import * as slackbot from "@blink-sdk/slackbot";
import { convertToModelMessages, streamText } from "ai";
import blink from "blink";

export default blink.agent({
  async sendMessages({ messages }) {
    return streamText({
      model: "anthropic/claude-sonnet-4",
      system: "You are a helpful assistant.",
      messages: convertToModelMessages(messages),
      tools: {
        ...slackbot.tools({
          messages,
        }),
      },
    });
  },
  async webhook(request) {
    if (slackbot.isOAuthRequest(request)) {
      return slackbot.handleOAuthRequest(request);
    }
    if (slackbot.isWebhook(request)) {
      return slackbot.handleWebhook(request);
    }
  },
});
```

## FAQ

### How can I add custom tools to my bot?

All messages created by Slack webhooks have special metadata.

You can use `slackbot.createClient` with this metadata to obtain
a scoped Slack client for the team that sent the message.

```ts
tools: {
  ...slackbot.tools({
    messages,
  }),
  slack_send_channel_message: tool({
  description: "Send a message to the current channel.",
    inputSchema: z.object({
      message: z.string(),
    }),
    execute: async ({ message }) => {
      const metadata = await slackbot.findLastMessageMetadata(messages);
      if (!metadata) {
        throw new Error("This chat isn't from Slack!");
      }
      const api = await slackbot.createClient(metadata);
      await api.chat.postMessage({
        channel: metadata.channel,
        text: message,
      });
      return {
        content: "Message sent to channel",
      };
    },
  }),
},
```

### How does authentication work?

The Slackbot SDK uses the Slack OAuth flow with the webhook.

OAuth tokens are stored with `blink.storage` and are automatically refreshed.

### Can anyone in my Slack chat with my bot?

By default, yes. But you can configure the tools however you want!

### How do I deploy my bot?

1. Create a new Slack app for production (or reuse the same one for development).

2. Set the Slack environment variables in `.env.production`.

3. Deploy your agent:

   ```bash
   blink deploy
   ```
