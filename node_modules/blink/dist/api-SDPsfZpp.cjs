const e=require(`./chunk-hhQzssFb.cjs`);let t=require(`util`);t=e.__toESM(t);const n=Object.freeze({find(e){throw Error(`Not implemented`)},create(e){throw Error(`Not implemented`)},message(e,t,n){throw Error(`Not implemented`)}});function r(e){return{version:`v0`,metadata:{displayName:e.displayName,description:e.description},fetch:async t=>{let n=new URL(t.url);switch(n.pathname){case`/sendMessages`:return a(t,e);case`/webhook`:return o(t,e);default:return new Response(`Not found`,{status:404})}}}}let i;async function a(e,n){if(e.method!==`POST`)return new Response(`Method not allowed`,{status:405});let r;try{r=await e.json()}catch{return new Response(`Invalid request`,{status:400})}let a;try{a=await n.sendMessages({messages:r.messages})}catch(e){return new Response(JSON.stringify({error:t.default.inspect(e)}),{status:500})}if(a instanceof Response)return a;if(a instanceof ReadableStream)return new Response(a,{headers:{"Content-Type":`text/event-stream`}});if(typeof a!=`object`||typeof a==`object`&&!(`toUIMessageStream`in a))throw Error(`The agent must return a "Response", "ReadableStream", or "toUIMessageStream" function.`);i||=new TextEncoder;let o=new TransformStream({transform(e,t){t.enqueue(i.encode(`data: ${JSON.stringify(e)}\n\n`))}}),s=a.toUIMessageStream();return s.pipeTo(o.writable),new Response(o.readable,{headers:{"Content-Type":`text/event-stream`}})}async function o(e,n){if(!n.webhook)return new Response(`No webhook function provided`,{status:501});try{let t=await n.webhook(e);return t||new Response(`OK`,{status:200})}catch(e){return new Response(JSON.stringify({error:t.default.inspect(e)}),{status:500})}}const s=`x-blink-stream-response-format`;function c(e,t){return e.headers.set(s,t),e}Object.defineProperty(exports,`StreamResponseFormatHeader`,{enumerable:!0,get:function(){return s}}),Object.defineProperty(exports,`agent`,{enumerable:!0,get:function(){return r}}),Object.defineProperty(exports,`chat`,{enumerable:!0,get:function(){return n}}),Object.defineProperty(exports,`withResponseFormat`,{enumerable:!0,get:function(){return c}});