const e=require(`./chunk-hhQzssFb.cjs`),t=require(`./client-CkqfTV5k.cjs`);require(`./api-SDPsfZpp.cjs`);const n=require(`./node-CGFEA9MV.cjs`);let r=require(`fs/promises`);r=e.__toESM(r);let i=require(`path`);i=e.__toESM(i);async function a(e,{outdir:t}={}){t||=await s(e);let n=(0,i.join)(t,`agent.js`),r=u(),a=await r.build({...l,entryPoints:[e],outfile:n});if(a.errors.length>0)throw Error(`Failed to build agent!`);return{outfile:n}}async function o(e){let t=await c(e,`package.json`);if(!t)throw Error(`No package.json found in ${e}`);let n=JSON.parse(await(0,r.readFile)(t,`utf-8`)),a=n.main;if(!a)throw Error(`"main" is not set in ${(0,i.relative)(process.cwd(),t)}. It should be set to the entrypoint of your agent.`);let o=(0,i.join)((0,i.dirname)(t),a),s=await(0,r.stat)(o);if(!s.isFile())throw Error(`${o} is not a file.`);return o}async function s(e){let t=await c(e,`node_modules`);if(!t){let t=await(0,r.stat)(e);return t.isDirectory()?(0,i.join)(e,`.blink`):(0,i.join)((0,i.dirname)(e),`.blink`)}let n=(0,i.join)(t,`.blink`);return await(0,r.mkdir)(n,{recursive:!0}),n}async function c(e,t){let n=e;for(;n!==(0,i.dirname)(n);){let e=(0,i.join)(n,t);try{return await(0,r.stat)(e),e}catch{}n=(0,i.dirname)(n)}}const l={bundle:!0,format:`cjs`,platform:`node`,target:`node18`,sourcemap:`inline`},u=()=>{try{return require(`esbuild`)}catch{throw Error("esbuild is not installed. Please install it with `bun add esbuild`.")}};async function d(e){let r=e?.entrypoint??await o(e?.cwd??process.cwd());if(!r)throw Error(`Unable to locate the entrypoint of the agent. Please specify it manually.`);let i;if(typeof Bun<`u`)i=n.requireAsCommonJS(r);else{let{outfile:e}=await a(r);i=n.requireAsCommonJS(e)}return t.createClientFromAgent(i)}exports.create=d;